{% extends "base.html" %}

{% block title %}{{ lesson.title }} - Dev Learning Hub{% endblock %}

{% block content %}
<div class="lesson-container">
    <div class="lesson-header">
        <div class="lesson-nav">
            <a href="{{ url_for('course_detail', course_id=lesson.course_id) }}" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                Retour au cours
            </a>
            <span class="lesson-path">
                {{ lesson.course.name }} > Le√ßon {{ lesson.order }}
            </span>
        </div>
        
        <div class="lesson-title-section">
            <h1>{{ lesson.title }}</h1>
            <div class="lesson-meta">
                <span class="points-reward">
                    <i class="fas fa-star"></i>
                    +{{ lesson.points_reward }} points
                </span>
                {% if completed %}
                    <span class="completed-badge">
                        <i class="fas fa-check-circle"></i>
                        Compl√©t√©e
                    </span>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="lesson-content">
        <!-- Section d'introduction enrichie -->
        <div class="lesson-introduction">
            <div class="intro-grid">
                <div class="lesson-overview">
                    <h2><i class="fas fa-lightbulb"></i> Aper√ßu de la le√ßon</h2>
                    <div class="lesson-description">
                        {% if lesson.course.name == "Shell/Terminal" %}
                            {% if lesson.order == 1 %}
                                <p>Cette premi√®re le√ßon vous introduit aux concepts fondamentaux du terminal. Vous apprendrez √† naviguer dans votre syst√®me de fichiers et √† ex√©cuter des commandes de base.</p>
                                <p><strong>Pourquoi c'est important :</strong> Le terminal est votre meilleur ami en tant que d√©veloppeur. Il vous donne un contr√¥le total sur votre environnement de travail.</p>
                            {% elif lesson.order == 2 %}
                                <p>Apprenez √† manipuler les fichiers et dossiers efficacement depuis le terminal. Ces comp√©tences sont essentielles pour organiser vos projets de d√©veloppement.</p>
                                <p><strong>Applications pratiques :</strong> Cr√©ation d'architectures de projets, organisation du code, gestion des assets.</p>
                            {% else %}
                                <p>Cette le√ßon approfondit les concepts du terminal et vous donne les outils pour devenir plus efficace dans votre travail quotidien.</p>
                            {% endif %}
                        {% elif lesson.course.name == "HTML5" %}
                            {% if lesson.order == 1 %}
                                <p>D√©couvrez la structure fondamentale d'une page web avec HTML5. Vous cr√©erez votre premi√®re page et comprendrez l'architecture du web moderne.</p>
                                <p><strong>√âvolution :</strong> HTML5 apporte de nouvelles balises s√©mantiques qui am√©liorent l'accessibilit√© et le SEO de vos sites.</p>
                            {% else %}
                                <p>Approfondissez vos connaissances HTML5 avec des techniques avanc√©es et des bonnes pratiques professionnelles.</p>
                            {% endif %}
                        {% elif lesson.course.name == "CSS3" %}
                            {% if lesson.order == 1 %}
                                <p>Plongez dans le monde du design web avec CSS3. Apprenez √† transformer vos pages HTML en interfaces visuellement attrayantes.</p>
                                <p><strong>Design moderne :</strong> CSS3 permet de cr√©er des interfaces qui rivalisent avec les applications natives.</p>
                            {% else %}
                                <p>Ma√Ætrisez les techniques CSS avanc√©es pour cr√©er des designs professionnels et responsives.</p>
                            {% endif %}
                        {% elif lesson.course.name == "JavaScript" %}
                            {% if lesson.order == 1 %}
                                <p>D√©couvrez JavaScript, le langage qui donne vie au web. Vous cr√©erez vos premi√®res interactions et comprendrez la programmation web.</p>
                                <p><strong>Universalit√© :</strong> JavaScript s'ex√©cute partout - navigateur, serveur, mobile, IoT.</p>
                            {% else %}
                                <p>Approfondissez JavaScript avec des concepts avanc√©s et des patterns de d√©veloppement modernes.</p>
                            {% endif %}
                        {% elif lesson.course.name == "Git" %}
                            {% if lesson.order == 1 %}
                                <p>Initiez-vous au contr√¥le de version avec Git. Apprenez √† sauvegarder et g√©rer l'√©volution de votre code comme un professionnel.</p>
                                <p><strong>Collaboration :</strong> Git est l'outil qui permet aux √©quipes de d√©veloppement de travailler ensemble efficacement.</p>
                            {% else %}
                                <p>Ma√Ætrisez Git pour devenir autonome dans la gestion de vos projets et la collaboration en √©quipe.</p>
                            {% endif %}
                        {% else %}
                            <p>{{ lesson.content[:200] }}{% if lesson.content|length > 200 %}...{% endif %}</p>
                        {% endif %}
                    </div>
                </div>

                <div class="lesson-objectives">
                    <h3><i class="fas fa-target"></i> Objectifs</h3>
                    <ul class="objectives-list">
                        {% if lesson.course.name == "Shell/Terminal" %}
                            {% if lesson.order == 1 %}
                                <li>Comprendre ce qu'est un terminal et son utilit√©</li>
                                <li>Ex√©cuter vos premi√®res commandes</li>
                                <li>Naviguer dans l'arborescence des fichiers</li>
                                <li>Utiliser l'aide int√©gr√©e (man pages)</li>
                            {% elif lesson.order == 2 %}
                                <li>Cr√©er et organiser des dossiers</li>
                                <li>Manipuler des fichiers efficacement</li>
                                <li>Comprendre les chemins relatifs et absolus</li>
                                <li>Utiliser les raccourcis de navigation</li>
                            {% else %}
                                <li>Approfondir les commandes essentielles</li>
                                <li>Automatiser des t√¢ches courantes</li>
                                <li>Comprendre les concepts avanc√©s</li>
                            {% endif %}
                        {% elif lesson.course.name == "HTML5" %}
                            {% if lesson.order == 1 %}
                                <li>Cr√©er votre premi√®re page HTML5</li>
                                <li>Comprendre la structure d'un document</li>
                                <li>Utiliser les balises essentielles</li>
                                <li>Respecter les standards du web</li>
                            {% else %}
                                <li>Ma√Ætriser les √©l√©ments HTML5 avanc√©s</li>
                                <li>Structurer du contenu complexe</li>
                                <li>Optimiser pour l'accessibilit√©</li>
                            {% endif %}
                        {% elif lesson.course.name == "CSS3" %}
                            {% if lesson.order == 1 %}
                                <li>Appliquer vos premiers styles</li>
                                <li>Comprendre les s√©lecteurs CSS</li>
                                <li>G√©rer les couleurs et typographies</li>
                                <li>Structurer votre code CSS</li>
                            {% else %}
                                <li>Ma√Ætriser les layouts avanc√©s</li>
                                <li>Cr√©er des animations CSS</li>
                                <li>Optimiser les performances</li>
                            {% endif %}
                        {% elif lesson.course.name == "JavaScript" %}
                            {% if lesson.order == 1 %}
                                <li>√âcrire vos premiers scripts JavaScript</li>
                                <li>Comprendre les variables et fonctions</li>
                                <li>Manipuler le DOM de base</li>
                                <li>G√©rer les √©v√©nements utilisateur</li>
                            {% else %}
                                <li>Ma√Ætriser les concepts avanc√©s</li>
                                <li>D√©velopper des applications interactives</li>
                                <li>G√©rer l'asynchrone efficacement</li>
                            {% endif %}
                        {% elif lesson.course.name == "Git" %}
                            {% if lesson.order == 1 %}
                                <li>Initialiser votre premier repository</li>
                                <li>Comprendre les concepts Git fondamentaux</li>
                                <li>Effectuer vos premiers commits</li>
                                <li>Suivre l'√©volution de votre code</li>
                            {% else %}
                                <li>Ma√Ætriser les branches et merges</li>
                                <li>Collaborer avec d'autres d√©veloppeurs</li>
                                <li>G√©rer les conflits efficacement</li>
                            {% endif %}
                        {% else %}
                            <li>Comprendre les concepts cl√©s</li>
                            <li>Appliquer la th√©orie en pratique</li>
                            <li>D√©velopper de bonnes habitudes</li>
                        {% endif %}
                    </ul>
                </div>

                <div class="lesson-duration">
                    <h3><i class="fas fa-clock"></i> Dur√©e estim√©e</h3>
                    <div class="time-breakdown">
                        <div class="time-item">
                            <span class="time-icon">üìñ</span>
                            <span>Lecture : 15-20 min</span>
                        </div>
                        <div class="time-item">
                            <span class="time-icon">üíª</span>
                            <span>Pratique : 20-30 min</span>
                        </div>
                        <div class="time-item">
                            <span class="time-icon">üéØ</span>
                            <span>Total : ~45 min</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2><i class="fas fa-book-open"></i> Contenu de la le√ßon</h2>
            <div class="lesson-text">
                {{ lesson.content }}
            </div>
            
            <!-- Contenu sp√©cifique selon le cours -->
            {% if lesson.course.name == "Shell/Terminal" %}
                <div class="code-examples">
                    <h3><i class="fas fa-terminal"></i> Exemples de commandes</h3>
                    {% if lesson.order == 1 %}
                        <div class="code-block">
                            <code>
# Afficher le r√©pertoire courant<br>
pwd<br><br>
# Lister les fichiers<br>
ls<br>
ls -la<br><br>
# Afficher l'aide d'une commande<br>
man ls
                            </code>
                        </div>
                    {% elif lesson.order == 2 %}
                        <div class="code-block">
                            <code>
# Changer de r√©pertoire<br>
cd /home/user<br>
cd ..<br>
cd ~<br><br>
# Cr√©er un r√©pertoire<br>
mkdir nouveau_dossier<br><br>
# Afficher l'arborescence<br>
tree
                            </code>
                        </div>
                    {% endif %}
                </div>
            {% elif lesson.course.name == "HTML5" %}
                <div class="code-examples">
                    <h3><i class="fas fa-code"></i> Exemples HTML</h3>
                    {% if lesson.order == 1 %}
                        <div class="code-block">
                            <code>
&lt;!DOCTYPE html&gt;<br>
&lt;html lang="fr"&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta charset="UTF-8"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Ma premi√®re page&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Bonjour le monde !&lt;/h1&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Ceci est ma premi√®re page HTML.&lt;/p&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;
                            </code>
                        </div>
                    {% endif %}
                </div>
            {% elif lesson.course.name == "CSS3" %}
                <div class="code-examples">
                    <h3><i class="fas fa-paint-brush"></i> Exemples CSS</h3>
                    {% if lesson.order == 1 %}
                        <div class="code-block">
                            <code>
/* S√©lecteur d'√©l√©ment */<br>
h1 {<br>
&nbsp;&nbsp;&nbsp;&nbsp;color: #00ff88;<br>
&nbsp;&nbsp;&nbsp;&nbsp;font-size: 2rem;<br>
}<br><br>
/* S√©lecteur de classe */<br>
.highlight {<br>
&nbsp;&nbsp;&nbsp;&nbsp;background-color: #fbbf24;<br>
&nbsp;&nbsp;&nbsp;&nbsp;padding: 10px;<br>
}<br><br>
/* S√©lecteur d'ID */<br>
#header {<br>
&nbsp;&nbsp;&nbsp;&nbsp;background: linear-gradient(45deg, #00ff88, #00d4ff);<br>
}
                            </code>
                        </div>
                    {% endif %}
                </div>
            {% elif lesson.course.name == "Langage C" %}
                <div class="code-examples">
                    <h3><i class="fas fa-code"></i> Exemples C</h3>
                    {% if lesson.order == 1 %}
                        <div class="code-block">
                            <code>
#include &lt;stdio.h&gt;<br><br>
int main() {<br>
&nbsp;&nbsp;&nbsp;&nbsp;printf("Hello, World!\n");<br>
&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br>
}
                            </code>
                        </div>
                    {% endif %}
                </div>
            {% elif lesson.course.name == "Python" %}
                <div class="code-examples">
                    <h3><i class="fas fa-code"></i> Exemples Python</h3>
                    {% if lesson.order == 1 %}
                        <div class="code-block">
                            <code>
# Affichage simple<br>
print("Hello, World!")<br><br>
# Variables<br>
nom = "Alice"<br>
age = 25<br>
print(f"Je m'appelle {nom} et j'ai {age} ans")<br><br>
# Liste<br>
fruits = ["pomme", "banane", "orange"]<br>
for fruit in fruits:<br>
&nbsp;&nbsp;&nbsp;&nbsp;print(f"J'aime les {fruit}s")
                            </code>
                        </div>
                    {% endif %}
                </div>
            {% endif %}

            <!-- Section Points cl√©s et bonnes pratiques -->
            <div class="key-concepts-section">
                <h3><i class="fas fa-key"></i> Points cl√©s √† retenir</h3>
                <div class="concepts-grid">
                    {% if lesson.course.name == "Shell/Terminal" %}
                        {% if lesson.order == 1 %}
                            <div class="concept-card">
                                <div class="concept-icon">üóÇÔ∏è</div>
                                <h4>Navigation</h4>
                                <p>Le terminal vous permet de naviguer dans votre syst√®me plus rapidement qu'une interface graphique.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üìñ</div>
                                <h4>Manuel</h4>
                                <p>Utilisez <code>man [commande]</code> pour acc√©der √† la documentation de n'importe quelle commande.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">‚ö°</div>
                                <h4>Efficacit√©</h4>
                                <p>Les raccourcis clavier et l'autocompl√©tion (Tab) acc√©l√®rent consid√©rablement votre travail.</p>
                            </div>
                        {% elif lesson.order == 2 %}
                            <div class="concept-card">
                                <div class="concept-icon">üìÅ</div>
                                <h4>Organisation</h4>
                                <p>Une bonne structure de dossiers facilite la maintenance de vos projets.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üîÑ</div>
                                <h4>Chemins</h4>
                                <p>Ma√Ætrisez les chemins relatifs (./, ../) et absolus (/home/user/) pour naviguer efficacement.</p>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "HTML5" %}
                        {% if lesson.order == 1 %}
                            <div class="concept-card">
                                <div class="concept-icon">üèóÔ∏è</div>
                                <h4>Structure</h4>
                                <p>HTML5 structure le contenu avec des balises s√©mantiques pour une meilleure accessibilit√©.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üåê</div>
                                <h4>Standards</h4>
                                <p>Respecter les standards W3C garantit la compatibilit√© avec tous les navigateurs.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">‚ôø</div>
                                <h4>Accessibilit√©</h4>
                                <p>Un HTML bien structur√© rend votre site accessible √† tous les utilisateurs.</p>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "CSS3" %}
                        {% if lesson.order == 1 %}
                            <div class="concept-card">
                                <div class="concept-icon">üé®</div>
                                <h4>S√©lecteurs</h4>
                                <p>Les s√©lecteurs CSS d√©terminent quels √©l√©ments styliser avec pr√©cision.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üì±</div>
                                <h4>Responsive</h4>
                                <p>D√®s le d√©but, pensez √† adapter vos designs pour tous les √©crans.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">‚ö°</div>
                                <h4>Performance</h4>
                                <p>Un CSS optimis√© am√©liore les temps de chargement de votre site.</p>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "JavaScript" %}
                        {% if lesson.order == 1 %}
                            <div class="concept-card">
                                <div class="concept-icon">üîÑ</div>
                                <h4>Interactivit√©</h4>
                                <p>JavaScript transforme des pages statiques en applications interactives.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üéØ</div>
                                <h4>DOM</h4>
                                <p>La manipulation du DOM permet de modifier le contenu en temps r√©el.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üêõ</div>
                                <h4>Debugging</h4>
                                <p>Les outils de d√©veloppement du navigateur sont essentiels pour d√©boguer.</p>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "Git" %}
                        {% if lesson.order == 1 %}
                            <div class="concept-card">
                                <div class="concept-icon">üì∏</div>
                                <h4>Commits</h4>
                                <p>Chaque commit est un instantan√© de votre projet √† un moment donn√©.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">üå≥</div>
                                <h4>Historique</h4>
                                <p>Git conserve tout l'historique de vos modifications pour une tra√ßabilit√© compl√®te.</p>
                            </div>
                            <div class="concept-card">
                                <div class="concept-icon">ü§ù</div>
                                <h4>Collaboration</h4>
                                <p>Git facilite le travail en √©quipe en g√©rant les contributions de chacun.</p>
                            </div>
                        {% endif %}
                    {% endif %}
                </div>
            </div>

            <!-- Section Erreurs courantes et solutions -->
            <div class="troubleshooting-section">
                <h3><i class="fas fa-exclamation-triangle"></i> Erreurs courantes et solutions</h3>
                <div class="troubleshooting-list">
                    {% if lesson.course.name == "Shell/Terminal" %}
                        {% if lesson.order == 1 %}
                            <div class="error-item">
                                <div class="error-title">
                                    <i class="fas fa-times-circle"></i>
                                    <strong>Commande non reconnue</strong>
                                </div>
                                <div class="error-solution">
                                    <p><strong>Probl√®me :</strong> "command not found"</p>
                                    <p><strong>Solution :</strong> V√©rifiez l'orthographe ou utilisez <code>which [commande]</code> pour voir si elle est install√©e.</p>
                                </div>
                            </div>
                            <div class="error-item">
                                <div class="error-title">
                                    <i class="fas fa-times-circle"></i>
                                    <strong>Permission refus√©e</strong>
                                </div>
                                <div class="error-solution">
                                    <p><strong>Probl√®me :</strong> "Permission denied"</p>
                                    <p><strong>Solution :</strong> Utilisez <code>sudo</code> pour les privil√®ges administrateur ou v√©rifiez les permissions avec <code>ls -la</code>.</p>
                                </div>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "HTML5" %}
                        {% if lesson.order == 1 %}
                            <div class="error-item">
                                <div class="error-title">
                                    <i class="fas fa-times-circle"></i>
                                    <strong>Page blanche</strong>
                                </div>
                                <div class="error-solution">
                                    <p><strong>Probl√®me :</strong> La page ne s'affiche pas</p>
                                    <p><strong>Solution :</strong> V√©rifiez que vous avez bien la structure HTML de base et que le fichier est sauvegard√© avec l'extension .html</p>
                                </div>
                            </div>
                        {% endif %}
                    {% elif lesson.course.name == "CSS3" %}
                        {% if lesson.order == 1 %}
                            <div class="error-item">
                                <div class="error-title">
                                    <i class="fas fa-times-circle"></i>
                                    <strong>Styles non appliqu√©s</strong>
                                </div>
                                <div class="error-solution">
                                    <p><strong>Probl√®me :</strong> Les styles CSS ne s'affichent pas</p>
                                    <p><strong>Solution :</strong> V√©rifiez le lien vers votre fichier CSS et la syntaxe de vos s√©lecteurs.</p>
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                </div>
            </div>

            <!-- Section Pour aller plus loin -->
            <div class="further-learning-section">
                <h3><i class="fas fa-rocket"></i> Pour aller plus loin</h3>
                <div class="resources-list">
                    {% if lesson.course.name == "Shell/Terminal" %}
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Bash Scripting Guide</h4>
                                <p>Approfondissez avec l'automatisation et les scripts bash</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Linux Command Line</h4>
                                <p>Explorez les commandes avanc√©es et les outils syst√®me</p>
                            </div>
                        </div>
                    {% elif lesson.course.name == "HTML5" %}
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Web Accessibility Guidelines</h4>
                                <p>Cr√©ez des sites accessibles √† tous les utilisateurs</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>HTML5 APIs</h4>
                                <p>D√©couvrez les APIs natives du navigateur</p>
                            </div>
                        </div>
                    {% elif lesson.course.name == "CSS3" %}
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>CSS Grid Garden</h4>
                                <p>Jeu interactif pour ma√Ætriser CSS Grid</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>CSS Animation Library</h4>
                                <p>Inspirez-vous des meilleures animations CSS</p>
                            </div>
                        </div>
                    {% elif lesson.course.name == "JavaScript" %}
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>JavaScript30</h4>
                                <p>30 projets en 30 jours pour pratiquer</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Modern JavaScript Features</h4>
                                <p>Explorez ES6+ et les derni√®res fonctionnalit√©s</p>
                            </div>
                        </div>
                    {% elif lesson.course.name == "Git" %}
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Git Workflows</h4>
                                <p>Apprenez les workflows professionnels (GitFlow, etc.)</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <i class="fas fa-external-link-alt"></i>
                            <div>
                                <h4>Advanced Git</h4>
                                <p>Techniques avanc√©es : rebase, cherry-pick, hooks</p>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="tips-section">
                <h3><i class="fas fa-lightbulb"></i> Conseils pratiques</h3>
                <div class="tips-list">
                    <div class="tip">
                        <i class="fas fa-check"></i>
                        <span>Prenez le temps de bien comprendre chaque concept avant de passer au suivant.</span>
                    </div>
                    <div class="tip">
                        <i class="fas fa-check"></i>
                        <span>Pratiquez r√©guli√®rement pour renforcer vos acquis.</span>
                    </div>
                    <div class="tip">
                        <i class="fas fa-check"></i>
                        <span>N'h√©sitez pas √† exp√©rimenter avec les exemples de code.</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <div class="progress-widget">
                <h3><i class="fas fa-chart-pie"></i> Votre progression</h3>
                <div class="user-stats">
                    <div class="stat">
                        <i class="fas fa-star"></i>
                        <span>{{ current_user.total_points }} points</span>
                    </div>
                    <div class="stat">
                        <i class="fas fa-level-up-alt"></i>
                        <span>Niveau {{ current_user.level }}</span>
                    </div>
                </div>
            </div>

            <div class="lesson-actions">
                {% if not completed %}
                    <button id="complete-lesson" class="btn btn-primary btn-full" onclick="completeLesson({{ lesson.id }})">
                        <i class="fas fa-check"></i>
                        Marquer comme termin√©e
                    </button>
                {% else %}
                    <div class="completed-message">
                        <i class="fas fa-trophy"></i>
                        <span>Le√ßon termin√©e !</span>
                    </div>
                {% endif %}
            </div>

            <div class="navigation-widget">
                <h3><i class="fas fa-map"></i> Navigation</h3>
                <!-- TODO: Ajouter navigation vers le√ßon pr√©c√©dente/suivante -->
                <div class="nav-buttons">
                    <button class="btn btn-secondary" disabled>
                        <i class="fas fa-chevron-left"></i>
                        Pr√©c√©dente
                    </button>
                    <button class="btn btn-secondary" disabled>
                        Suivante
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal pour les troph√©es -->
<div id="trophy-modal" class="modal">
    <div class="modal-content">
        <div class="trophy-celebration">
            <h2><i class="fas fa-trophy"></i> Nouveau troph√©e d√©bloqu√© !</h2>
            <div id="trophy-details"></div>
            <button onclick="closeTrophyModal()" class="btn btn-primary">
                <i class="fas fa-times"></i>
                Fermer
            </button>
        </div>
    </div>
</div>

<script>
function completeLesson(lessonId) {
    fetch(`/complete_lesson/${lessonId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Mettre √† jour l'interface
            const button = document.getElementById('complete-lesson');
            button.outerHTML = `
                <div class="completed-message">
                    <i class="fas fa-trophy"></i>
                    <span>Le√ßon termin√©e !</span>
                </div>
            `;
            
            // Afficher les points gagn√©s
            showPointsEarned(data.points_earned, data.total_points);
            
            // Afficher les nouveaux troph√©es si il y en a
            if (data.new_trophies && data.new_trophies.length > 0) {
                showNewTrophies(data.new_trophies);
            }
        } else {
            alert('Erreur: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert('Une erreur est survenue');
    });
}

function showPointsEarned(points, total) {
    // Animation des points
    const notification = document.createElement('div');
    notification.className = 'points-notification';
    notification.innerHTML = `
        <i class="fas fa-star"></i>
        +${points} points !
        <br>
        <small>Total: ${total} points</small>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

function showNewTrophies(trophies) {
    const modal = document.getElementById('trophy-modal');
    const details = document.getElementById('trophy-details');
    
    details.innerHTML = trophies.map(trophy => `
        <div class="trophy-item">
            <span class="trophy-icon">${trophy.icon}</span>
            <span class="trophy-name">${trophy.name}</span>
        </div>
    `).join('');
    
    modal.style.display = 'flex';
}

function closeTrophyModal() {
    document.getElementById('trophy-modal').style.display = 'none';
}
</script>
{% endblock %}
